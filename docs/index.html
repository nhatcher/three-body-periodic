<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Three-Body Simulation</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="modal.css" />
  <link rel="stylesheet" href="legend.css" />
  <link rel="stylesheet" href="help.css" />
</head>
<body>
  <header>
    <div class="controls">
      <div class="control-row">
        <!-- Settings -->
        <button class="primary" id="settings" title="Settings"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-settings2-icon lucide-settings-2"><path d="M14 17H5"/><path d="M19 7h-9"/><circle cx="17" cy="17" r="3"/><circle cx="7" cy="7" r="3"/></svg></button>
          <div class="spacer"></div>
        <!-- GitHub link -->
        <button class="primary" id="github"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-github-icon lucide-github"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></svg></button>
        <!-- Help -->
        <button class="primary" id="help"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-question-mark-icon lucide-circle-question-mark"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><path d="M12 17h.01"/></svg></button>
      </div>
      <div class="last-row">
        <div class="control-row">
        <select id="example-class">
          <optgroup label="2D Examples">
            <option value="free_fall">Free Fall (Ling-Liao)</option>
            <option value="free_fall_puzynin_sd">Free Fall (symmetric Puzynin)</option>
            <option value="free_fall_puzynin_600">Free Fall (first 600, Puzynin)</option>
            <option value="equal_mass">Equal Mass</option>
            <option value="unequal_mass">Unequal Mass</option>
            <option value="choreographies">Choreographies</option>
            <option value="bhh_satellites">BHH Satellites</option>
            <option value="broucke_boggs">Broucke Boggs</option>
            <option value="matt_sheen">Matt Sheen</option>
          </optgroup>
          <optgroup label="3D Examples">
            <option value="3d_examples">Examples 3D</option>
          </optgroup>
          <optgroup label="Personal">
            <option value="custom">Custom Examples</option>
            <option value="bookmarks">Favorites</option>
          </optgroup>
        </select>
        <select id="example"></select>
        <!-- cycle through stack buttons -->
        <div class="stack">
          <button class="primary" id="cycle-through"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-image-play-icon lucide-image-play"><path d="M15 15.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997a1 1 0 0 1-1.517-.86z"/><path d="M21 12.17V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h6"/><path d="m6 21 5-5"/><circle cx="9" cy="9" r="2"/></svg></button>
          <button class="primary" id="stop-cycle-through" disabled><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-square-icon lucide-square"><rect width="18" height="18" x="3" y="3" rx="2"/></svg></button>
          </div>
        </div>
        <div class="control-row control-time-row">
        <input id="control-time" type="range" min="0" max="1000" step="1" value="1000" />
        </div>
        <div class="control-row">
          <button id="new-example" class="primary"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-pencil-line-icon lucide-pencil-line"><path d="M13 21h8"/><path d="m15 5 4 4"/><path d="M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"/></svg></button>
          <div class="spacer"></div>
          <!-- Favorites stack buttons -->
          <div class="stack">
            <button class="primary" id="bookmark"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-heart-icon lucide-heart"><path d="M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5"/></svg></button>
            <button class="primary" id="remove-bookmark"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-heart-off-icon lucide-heart-off"><path d="M10.5 4.893a5.5 5.5 0 0 1 1.091.931.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 1.872-1.002 3.356-2.187 4.655"/><path d="m16.967 16.967-3.459 3.346a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5a5.5 5.5 0 0 1 2.747-4.761"/><path d="m2 2 20 20"/></svg></button>
           </div>

          <div class="divider"></div>
          <button class="primary" id="previous-example"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-left-icon lucide-chevron-left"><path d="m15 18-6-6 6-6"/></svg></button>
          <!-- Play/Pause stacked button -->
          <div class="stack">
            <button class="primary" id="play" disabled><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play-icon lucide-play"><path d="M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z"/></svg></button>
            <button class="primary" id="pause"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-pause-icon lucide-pause"><rect x="14" y="3" width="5" height="18" rx="1"/><rect x="5" y="3" width="5" height="18" rx="1"/></svg><circle cx="12" cy="12" r="10"/></svg></button>
          </div>
          <button class="primary" id="next-example"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right-icon lucide-chevron-right"><path d="m9 18 6-6-6-6"/></svg></button>
        </div>
      </div>
          <!-- <button id="record" class="primary">Record video</button> -->

    </div>
  </header>
  <div id="canvasWrap" tabindex="0">
    <canvas id="plot"></canvas>
    <div id="legend" data-display="false"><span id="legend-toggle">+</span><div id="legend-content"></div></div>
  </div>
  <div id="footer">
  <div class="status" id="status"></div>
  <div class="spacer"></div>
  <div class="coords" id="coords"></div>
  </div>
<dialog id="new-example-dialog" aria-labelledby="new-example-title">
  <form method="dialog" id="new-example-form" class="modal">
    <h2 id="new-example-title">New 3-Body Initial Conditions (IC)</h2>

    <label class="stack">
      <span class="label">Name</span>
      <input type="text" id="ex-name" placeholder="e.g. My custom ICs" required />
    </label>

    <div class="modal-grid">
      <div class="head"></div>
      <div class="head">Mass</div>
      <div class="head">x</div>
      <div class="head">y</div>
      <div class="head">z</div>
      <div class="head">v<sub>x</sub></div>
      <div class="head">v<sub>y</sub></div>
      <div class="head">v<sub>z</sub></div>

      <!-- Body 1 -->
      <div class="row-label">Body 1</div>
      <input inputmode="decimal" required id="modal-m1"  placeholder="1"   />
      <input inputmode="decimal" required id="modal-x1"  placeholder="0.0" />
      <input inputmode="decimal" required id="modal-y1"  placeholder="0.0" />
      <input inputmode="decimal" required id="modal-z1"  placeholder="0.0" />
      <input inputmode="decimal" required id="modal-vx1" placeholder="0.1" />
      <input inputmode="decimal" required id="modal-vy1" placeholder="0.0" />
      <input inputmode="decimal" required id="modal-vz1" placeholder="0.0" />

      <!-- Body 2 -->
      <div class="row-label">Body 2</div>
      <input inputmode="decimal" required id="modal-m2"  placeholder="1"   />
      <input inputmode="decimal" required id="modal-x2"  placeholder="1.0" />
      <input inputmode="decimal" required id="modal-y2"  placeholder="0.0" />
      <input inputmode="decimal" required id="modal-z2"  placeholder="0.0" />
      <input inputmode="decimal" required id="modal-vx2" placeholder="0.0" />
      <input inputmode="decimal" required id="modal-vy2" placeholder="0.1" />
      <input inputmode="decimal" required id="modal-vz2" placeholder="0.0" />

      <!-- Body 3 -->
      <div class="row-label">Body 3</div>
      <input inputmode="decimal" required id="modal-m3"  placeholder="1"   />
      <input inputmode="decimal" required id="modal-x3"  placeholder="-1.0"/>
      <input inputmode="decimal" required id="modal-y3"  placeholder="0.0" />
      <input inputmode="decimal" required id="modal-z3"  placeholder="0.0" />
      <input inputmode="decimal" required id="modal-vx3" placeholder="0.0" />
      <input inputmode="decimal" required id="modal-vy3" placeholder="-0.1"/>
      <input inputmode="decimal" required id="modal-vz3" placeholder="0.0" />

      <div class="row-label">Period/Angle</div>
      <input inputmode="decimal" required id="modal-period" placeholder="1" />
      <input inputmode="decimal" required id="modal-angle" placeholder="1" />
    </div>
    

    <menu class="modal-actions">
      <button value="primary" type="button" id="delete-new-ex">Delete</button>
      <button value="cancel" type="button" id="cancel-new-ex">Cancel</button>
      <button class="primary" value="submit" id="create-new-ex">Save</button>
    </menu>
  </form>
</dialog>

<dialog id="settings-dialog" aria-labelledby="settings-title">
  <form method="dialog" class="modal" id="settings-form">
    <h2 id="settings-title">Settings</h2>
    <div>
      <label for="method" class="label-left">Solver</label>
      <select id="method">
        <optgroup label="Recommended">
        <option value="dop853">DOP853</option>
        <option value="feagin14">Feagin14</option>
        </optgroup>
        <optgroup label="Other Integrators">
        <option value="rk4">RK4</option>
        <option value="verlet">Velocity Verlet</option>
        </optgroup>
      </select>
    </div>
    <div>
      <label for="full-paths" class="label-left">Draw full Paths</label>
      <input type="checkbox" id="full-paths" />
    </div>
    <menu class="modal-actions">
      <button value="cancel" class="primary">Close</button>
    </menu>
  </form>
</dialog>

<dialog id="help-dialog" aria-labelledby="help-title">
  <form method="dialog" class="modal" id="help-form">
    <section class="help-body" id="help-body" role="tabpanel" tabindex="0" aria-live="polite"></section>
    <div class="modal-actions">
      <button type="button" class="help-back" data-goto="help-index">← Back to index</button>
      <div class="spacer"></div>
      <button value="cancel" class="primary">Close</button>
    </div>
  </form>
</dialog>


<template id="help-controls">
  <h2>Controls</h2>
  <p>Quick guide to the UI:</p>
  <ul>
    <li><strong>Examples</strong>: pick a class, then a specific orbit.</li>
    <li><strong>Play/Pause</strong>: animate the solution; use ←/→ to step.</li>
    <li><strong>Slider</strong>: scrub from 0 → period <em>t</em>.</li>
    <li><strong>Cycle-through</strong>: auto-advance examples.</li>
    <li><strong>Favorite</strong>: bookmark the current IC for quick access.</li>
    <li><strong>Legend</strong>: toggle to see masses, colors, etc.</li>
    <li><strong>Settings</strong>: choose integrator (DOP853, Feagin14, RK4, Verlet).</li>
  </ul>
</template>



<dialog id="info-dialog" aria-labelledby="info-title">
  <form method="dialog" class="modal" id="info-form">
    <div id="info-content"></div>
    <menu class="modal-actions">
      <button value="cancel" class="primary">Close</button>
    </menu>
  </form>
</dialog>

<template id="info-header-example-class">
  <h2 id="info-title">Example Class</h2>
  <p>You will find here different classes of examples of periodic 3 body orbits</p>
</template>

<!-- METHOD helps -->
<template id="help-method">
  <h2>ODE numerical solvers</h2>
  <p>Choose here the numerical integration method used to solve the there body problem (Recommended DOP853)</p>
  <p>The differential equation is solved in a web-worker</p>
  <h3 id="info-title">DOP853 (8(5,3))</h3>
  <p>Dormand-Prince method of order 8. This is the recommended method for most problems.</p>
  <h3 id="info-title">Feagin 14(12)</h3>
  <p>Very high-order explicit RK with embedded error. Heavy but superb when you need extreme accuracy/precision.</p>
  <p>Uses multiple precision arithmetic. Solving an example might take minutes or hours.</p>
  <h3 id="info-title">RK4</h3>
  <p>Classic fixed-step 4th order. Simple to code and understand. It generally doesn't perform well in these examples</p>
  <h3 id="info-title">Velocity Verlet</h3>
  <p>Symplectic 2nd order—great long-term energy behavior for Hamiltonian systems with a suitably small dt.</p>
  <p>It is here just as an example</p>
</template>

<template id="help-about">
  <h2 id="info-title">About</h2>
  <p>The three-body problem simulator helps users visualize and understand the complex gravitational interactions between three celestial bodies.</p>
  <p>It features a collection of known periodic orbits, allowing users to explore and learn about these fascinating solutions to the three-body problem.</p>
  <p>Users can select different example classes, control the simulation, and even create and save their own initial conditions.</p>
  <p>The simulator is built using Rust, Wasm, JavaScript and HTML5, leveraging the power of modern web technologies to provide an interactive and educational experience.</p>
</template>

<!-- EXAMPLE-CLASS helps -->
<template id="help-example-choreographies">
  <h2 id="info-title">Choreographies</h2>
  <p>All three bodies share the same orbit.</p> <p>It is hypnotic to see them dance around the same path.</p>
  <p>The by now well known "eight-figure" choreography is a remarkable example (discovered by <a href="https://doi.org/10.1103/PhysRevLett.70.3675" target="_blank" rel="noopener noreferrer">Moore in 1993</a>), and by <a href="https://doi.org/10.1007/s002200000269" target="_blank" rel="noopener noreferrer">Chenciner and Montgomery in 2000</a>).</p>
  <p>The examples here where discovered by Carles Simó (Paul Masson rescued the initial conditions in <a href="https://analyticphysics.com/Gravitational%20Choreographies/Sim%C3%B3's%20Three-Body%20Choreographies%20in%20Action.htm" target="_blank" rel="noopener noreferrer">here</a>)</p>
</template>

<template id="help-example-equal_mass">
  <h2 id="info-title">Equal Mass</h2>
  <p>Periodic orbits with equal masses. Initiated by Šuvakov and Dmitrašinović in their paper <a href="" target="_blank" rel="noopener noreferrer">Three Classes of Newtonian Three-Body Planar Periodic Orbits</a>, here we have the list from <a href="https://arxiv.org/abs/1705.00527" target="_blank" rel="noopener noreferrer">More than six hundreds new families of Newtonian periodic planar collisionless three-body orbits
</a></p>
  <p>See also their <a href="https://github.com/sjtu-liao/three-body" target="_blank" rel="noopener noreferrer">website</a></p>
</template>

<template id="help-example-unequal_mass">
  <h2 id="info-title">Unequal Mass</h2>
  <p>Periodic orbits with unequal masses. Many were found by Li and Liao in their paper <a href="https://arxiv.org/abs/1709.04775" target="_blank" rel="noopener noreferrer">The 1223 new periodic orbits of planar three-body problem with unequal mass and zero angular momentum</a></p>
  <p>See also their <a href="https://github.com/sjtu-liao/three-body" target="_blank" rel="noopener noreferrer">GitHub repo</a></p>
</template>

<template id="help-example-3d_examples">
  <h2 id="info-title">Examples 3D</h2>
  <p>Some periodic orbits in 3D. These are not as well studied as the planar case</p>
  <p>See for example the paper <a href="https://arxiv.org/abs/2508.08568" target="_blank" rel="noopener noreferrer">Discovery of 10,059 new three-dimensional periodic orbits of general three-body problem</a> by Li and Liao</p>
</template>

<template id="help-example-free_fall">
  <h2 id="info-title">Free Fall (Ling-Liao)</h2>
  <p>The 316 periodic orbits discovered by Xiaoming Li and Shijun Liao in their paper <a href="https://arxiv.org/abs/1805.07980" target="_blank" rel="noopener noreferrer">Collisionless periodic orbits in the free-fall three-body problem</a></p>
  <p>These are 2D solutions with no initial speed. See also their <a href="https://github.com/sjtu-liao/three-body" target="_blank" rel="noopener noreferrer">GitHub repo</a></p>
</template>

<template id="help-example-free_fall_puzynin_sd">
  <h2 id="info-title">Free Fall</h2>
  <p>These solutions were found by I. Hristov, R. Hristova, T. Puzynina, Z. Sharipov and Z. Tukhliev in their paper <a href="https://arxiv.org/abs/2503.00432">Numerical search for three-body periodic free-fall orbits with central symmetry</a></p>
  <p>I call it the Puzynin solutions, in honour of their teacher <a href="https://www.jinr.ru/posts/igor-victorovich-puzynin-condolences/" target="_blank" rel="noopener noreferrer">Igor Viktorovich Puzynin</a></p>
  <p>These are 2D solutions with no initial speed. I have included here only the so called <it>self-dual symmetric solutions</it></p>
  <p>See also their website <a href="https://db2.fmi.uni-sofia.bg/3bodyfree/" target="_blank" rel="noopener noreferrer">https://db2.fmi.uni-sofia.bg/3bodyfree/</a></p>
  <p>Some of this orbits require a multiple precision method for their solution</p>
</template>

<template id="help-example-free_fall_puzynin_600">
  <h2 id="info-title">Free Fall</h2>
  <p>These solutions were found by I. Hristov, R. Hristova, T. Puzynina, Z. Sharipov and Z. Tukhliev in their paper <a href="https://arxiv.org/abs/2503.00432">Numerical search for three-body periodic free-fall orbits with central symmetry</a></p>
  <p>I call it the Puzynin solutions, in honour of their teacher <a href="https://www.jinr.ru/posts/igor-victorovich-puzynin-condolences/" target="_blank" rel="noopener noreferrer">Igor Viktorovich Puzynin</a></p>
  <p>These are 2D solutions with no initial speed. I have included here the first 600 solutions</p>
  <p>See also their website <a href="https://db2.fmi.uni-sofia.bg/3bodyfree/" target="_blank" rel="noopener noreferrer">https://db2.fmi.uni-sofia.bg/3bodyfree/</a></p>
  <p>Some of this orbits require a multiple precision method for their solution</p>
</template>

<template id="help-example-bhh_satellites">
  <h2 id="info-title">BBH Satellites</h2>
  <p>These are not periodic orbits, this are periodic in a rotating frame of reference</p>
</template>


<template id="help-example-custom">
  <h2 id="info-title">Custom examples</h2>
  <p>You can create those examples by clicking edit.</p>
</template>

<script type="module" src="script.js"></script>
<script type="module" src="modal.js"></script>
<script type="module" src="help.js"></script>
</body>
</html>
